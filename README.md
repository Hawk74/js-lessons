Привет сегодня расскажу как можно с помощью отладчика решить на мой взгляд не тривиальную проблему в джаваскрипт.

В джаваскрипт обьекты передаются по ссылке. Другими словами когда мы передаем обьект в функцию или где угодно меняем его свойства

то все кто работал или работает с этой переменной или параметром получат изменение свойства 

Часто такое поведение искажает данные пользователя и является не желательным

Поиск источника нежелательных изменений свойства может занять долгое время 

Давайте рассмотрим пример сейчас веб программа не работает так как 

Видем что в консоли есть ошибка

Я это вывод стека ошибок

он содержит последовательность вызовов от начала запуска скрипта джаваскрипт

Читаем самое верхнее сообщение
  Uncaught (in promise) TypeError: Cannot read property 'slice' of undefined - Необработанно в промис ошибка типов Не могу прочитать свойство слайс от андефайн

Нажимаем на ссылку и переходим к месту ошибки

Видем что ошибочное выражение состоит из 4х операторов два опретора точка один оператор-разделитель запятая и один оператор группировки

Итак сначало вычисляется выражение первого оператора точка this.firstName по тексту ошибки ясно что это выражение возвращает андефайн

так как выполнение следующего оператор точка не работает с не обьектными типами и его выполнени приводит к ошибке 

таким образом выполнение второго оператора приводит к ошибке не могу получить свойство slice от андефан

Получается что где то этому свойству было присвоено значение андефайн....

Чтобы решить эту проблему попробуем пойти от обратного Воспрользуемся инструментом отладки остановка на исключении

И уже двигаясь от места ошибки по стеку вызовов попробуем перейти к месту ошибки

Выбираем инструмент остановка на исключении 

перезапускаем программу

Видим стеке всего два вызова переходим в предыдущий

Видим что явно нет никакаких инструкции которые изменяют свойство

Делаем вывод что изменение не происходит в этом стеке вызовов, как вам такое ?

И как ошибку найти теперь ?

Пожалуйста поставьте видео на паузу и напишите в коментах как бы вы нашли эту ошибку ?

Ребята кто со мной работает и кому я это рассказал на асесменте или в ходе диалога напишите плиз звездочку в коменте 

Мне очень интересно узнать как другие специалисты джаваскипт решают подобные проблемы.

Знаете когда я встретился с этим поведением джаваскрипт впервый  я потратил пару часов на расследование....

Отключем инструмент пауза на исключении.

Итак вот наш новый план мы определим в обьекте юзер свойство firstName используя геттер и сеттер

в сеттер установим точку останова используя оператор debugger и инструкцию точка с запятой

потом двигаясь снова по стеку вызавов найдем место ошибки 

перезапускаем программу

итак отладчик остановился в сеттере до того как новое значение будет записанно в обьект

видем что значение параметра value undefined

теперь используя стек вызовов мы легко переходим в предыдущий вызов и победааааа ура.

есть еще более простой способ решить эту проблему используя инструмет отладки остановка на исключении

вот наш новый план сделаем обьект юзер не обьектом и используя остановку по исключению легко попадем к месту искажения

так как мы знаем что при попытке получения свойства от андефайн возникает ошибка

включаем инструмент остановка на исключении

присваиваем переменной user undefined

перезапускаем программу 

и вот мы снова остановились в месте искажения свойства firstName 

и вот это все что я хотел вам сегодня рассказать об отладке нежелательных изменений у обьектов

спасибо вам за просмотр ставьте лайки подписывайтесь на канал делитесь этим видео с друзьями досвидания


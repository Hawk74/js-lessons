Привет сегодня расскажу как можно с помощью отладчика решить на мой взгляд не тривиальную проблему JavaScript.
В JavaScript  объекты передаются по ссылке. Другими словами когда мы передаем объект в функцию или где угодно меняем его свойства используя оператор присваивания, все инструкции которые работал или работают с этой переменной или параметром по ссылке получат изменение свойства.
Часто такое поведение искажает данные пользователя и является не желательным.
Поиск источника нежелательных изменений свойства может занять долгое время.
Давайте рассмотрим пример сейчас веб программа не работает так как в консоли есть ошибка и нет вывода ФИО.
Ошибка получения свойства slice у undefined
Ошибка получения свойства slice у undefined

Читаем самое верхнее сообщение в консоли Uncaught (in promise) TypeError: Cannot read property 'slice' of undefined - Необработанно в промис ошибка типов не могу прочитать свойство slice от андефайн.
Нажимаем на ссылку и переходим к месту ошибки.


Видем что ошибочное выражение состоит из 4х операторов два опретора точка один оператор-разделитель запятая и один оператор группировки
Итак сначало вычисляется левое выражение  this.firstName.  Левый и правый операнды оператора точка возвращают undefined.
Выполнение следующего оператор точка вызывает нашу ошибку. Так ка оператор точка работает только с объектными типами его выполнение от undefined приводит к ошибке - не могу получить свойство slice от undefined.
Получается что где то этому свойству было присвоено значение undefined....
Чтобы решить эту проблему попробуем пойти от обратного. Воспрользуемся инструментом отладки остановка на исключении.
И уже двигаясь от места ошибки по стеку вызовов вниз попробуем перейти к месту ошибки.
Выбираем инструмент остановка на исключении



перезапускаем программу.

Видим что в стеке всего два вызова


переходим в предыдущий вызов


Видим что явно нет  инструкции которая изменяют свойство firstName.
Делаем вывод что изменение не происходит в этом стеке вызовов, как вам такое ?
И как ошибку найти теперь ?
Пожалуйста напишите в коментах как бы вы нашли эту ошибку ?
Ребята кто со мной работает и кому я это рассказал на асесменте или в ходе диалога напишите плиз звездочку в коменте.
Мне очень интересно узнать как другие специалисты JavaScript  решают подобные проблемы.
Знаете когда я встретился с этим поведением JavaScript  впервые, я потратил пару часов на расследование и выдрал клок волос с челки....
Отключем инструмент пауза на исключении.
Итак, вот наш новый план мы определим в обьекте user свойство firstName используя геттер и сеттер.
В сеттер  добавим инструкцию отладки  используя оператор debugger и оператор точка с запятой
потом снова двигаясь по стеку вызовов найдем инструкцию которая меняет свойство firstName.
перезапускаем программу


итак отладчик остановился в сеттере до того как новое значение будет записанно в обьект
видем что значение параметра value undefined
теперь используя стек вызовов мы легко переходим в предыдущий вызов 


иииии, победааааа ура.
Есть еще более простой способ решить эту проблему используя инструмет отладки остановка на исключении.
Вот наш новый план сделаем обьект юзер не обьектом и используя инструмент остановку по исключению легко попадем к ошибочной инструкции.
так как мы знаем что при попытке получения свойства от андефайн возникает ошибка.
включаем инструмент остановка на исключении
присваиваем переменной user undefined


перезапускаем программу


и вот мы снова остановились в месте искажения свойства firstName
Это все, что я хотел вам сегодня рассказать об отладке нежелательных изменений у объектов.

спасибо вам за прочтение статьи ставьте лайки подписывайтесь на канал делитесь этим видео и статьей с друзьями, всего хорошего.




